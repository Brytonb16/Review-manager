<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Northwind Reviews | Review Response Command Center</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <style>
      :root {
        --bg: #f3f5fb;
        --panel: #ffffff;
        --muted: #5b6475;
        --ink: #111827;
        --line: #dbe2ef;
        --primary: #2563eb;
        --primary-dark: #1d4ed8;
        --danger: #ef4444;
        --warning: #f59e0b;
        --ok: #10b981;
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: "Inter", system-ui, sans-serif;
        background: var(--bg);
        color: var(--ink);
      }

      .layout {
        display: grid;
        grid-template-columns: 280px 1fr;
        min-height: 100vh;
      }

      aside {
        background: #0f172a;
        color: #dbeafe;
        padding: 22px 18px;
      }

      .brand {
        font-weight: 800;
        font-size: 1.05rem;
        margin-bottom: 22px;
      }

      .badge {
        display: inline-block;
        background: rgba(37, 99, 235, 0.22);
        color: #bfdbfe;
        border: 1px solid rgba(191, 219, 254, 0.28);
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 0.76rem;
        margin-bottom: 20px;
      }

      .nav-btn {
        width: 100%;
        border: 1px solid rgba(148, 163, 184, 0.2);
        background: transparent;
        color: #e2e8f0;
        border-radius: 10px;
        padding: 10px 12px;
        text-align: left;
        margin: 8px 0;
        cursor: pointer;
      }

      .nav-btn.active, .nav-btn:hover {
        background: rgba(37, 99, 235, 0.25);
        border-color: rgba(37, 99, 235, 0.8);
      }

      main {
        padding: 26px;
      }

      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }

      h1 { font-size: clamp(1.5rem, 2.3vw, 2.2rem); margin: 0; }
      .sub { color: var(--muted); margin-top: 6px; }

      .btn {
        border: 1px solid transparent;
        background: var(--primary);
        color: white;
        border-radius: 10px;
        padding: 10px 14px;
        font-weight: 600;
        cursor: pointer;
      }
      .btn:hover { background: var(--primary-dark); }

      .stats {
        margin-top: 22px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
        gap: 12px;
      }

      .card {
        background: var(--panel);
        border: 1px solid var(--line);
        border-radius: 14px;
        padding: 14px;
      }

      .stat-number { font-size: 1.7rem; font-weight: 800; margin: 8px 0; }
      .muted { color: var(--muted); font-size: 0.92rem; }

      .workspace {
        margin-top: 18px;
        display: grid;
        grid-template-columns: 1.4fr 1fr;
        gap: 14px;
      }

      .filters {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 12px;
      }

      select, input, textarea {
        border: 1px solid var(--line);
        background: white;
        border-radius: 8px;
        padding: 9px 10px;
        font: inherit;
      }

      .review-list {
        display: grid;
        gap: 10px;
        max-height: 560px;
        overflow: auto;
      }

      .review-item {
        border: 1px solid var(--line);
        border-radius: 10px;
        padding: 12px;
        cursor: pointer;
      }

      .review-item.active {
        border-color: var(--primary);
        box-shadow: inset 0 0 0 1px var(--primary);
      }

      .stars { color: #f59e0b; font-size: 0.95rem; }
      .meta { color: var(--muted); font-size: 0.8rem; margin-top: 5px; }

      .priority {
        display: inline-block;
        border-radius: 999px;
        padding: 3px 8px;
        font-size: 0.73rem;
        font-weight: 700;
        margin-top: 6px;
      }
      .priority.high { background: #fee2e2; color: #b91c1c; }
      .priority.medium { background: #fef3c7; color: #b45309; }
      .priority.low { background: #dcfce7; color: #15803d; }

      .detail-header { display: flex; justify-content: space-between; gap: 8px; align-items: center; }
      textarea { width: 100%; min-height: 140px; resize: vertical; }
      .actions { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 12px; }
      .btn.secondary { background: white; color: var(--ink); border-color: var(--line); }
      .btn.secondary:hover { background: #f8fafc; }
      .btn.warn { background: var(--warning); }
      .btn.danger { background: var(--danger); }
      .status {
        margin-top: 10px;
        padding: 9px 10px;
        border-radius: 8px;
        background: #ecfeff;
        color: #155e75;
        border: 1px solid #a5f3fc;
        display: none;
      }

      @media (max-width: 980px) {
        .layout { grid-template-columns: 1fr; }
        aside { padding: 14px; }
        .workspace { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <div class="layout">
      <aside>
        <div class="brand">Northwind Reviews</div>
        <div class="badge">BirdEye-style review operations</div>
        <button class="nav-btn active">Review Inbox</button>
        <button class="nav-btn">Auto Reply Playbooks</button>
        <button class="nav-btn">Locations</button>
        <button class="nav-btn">Analytics</button>
        <button class="nav-btn">Team SLA</button>
      </aside>

      <main>
        <div class="header">
          <div>
            <h1>Automatic Review Response & Management</h1>
            <p class="sub">Prioritize reviews, draft responses, assign owners, and track status in one dashboard.</p>
          </div>
          <button class="btn" id="bulkReply">Run Auto-Reply on Filter</button>
        </div>

        <section class="stats">
          <div class="card"><div class="muted">Pending Reviews</div><div class="stat-number" id="statPending">0</div><div class="muted">Need response now</div></div>
          <div class="card"><div class="muted">Needs Escalation</div><div class="stat-number" id="statEscalated">0</div><div class="muted">1-2 star mentions</div></div>
          <div class="card"><div class="muted">Avg Response Time</div><div class="stat-number">1h 14m</div><div class="muted">Across 12 locations</div></div>
          <div class="card"><div class="muted">Auto-Draft Ready</div><div class="stat-number" id="statDrafts">0</div><div class="muted">One-click send queue</div></div>
        </section>

        <section class="workspace">
          <div class="card">
            <div class="filters">
              <select id="locationFilter"><option value="all">All locations</option></select>
              <select id="ratingFilter">
                <option value="all">All ratings</option>
                <option value="5">5 stars</option>
                <option value="4">4 stars</option>
                <option value="3">3 stars</option>
                <option value="2">2 stars</option>
                <option value="1">1 star</option>
              </select>
              <select id="statusFilter">
                <option value="all">All statuses</option>
                <option value="pending">Pending</option>
                <option value="drafted">Drafted</option>
                <option value="sent">Sent</option>
                <option value="escalated">Escalated</option>
              </select>
              <input id="searchFilter" placeholder="Search customer text..." />
            </div>
            <div class="review-list" id="reviewList"></div>
          </div>

          <div class="card">
            <div class="detail-header">
              <h3 id="detailName">Select a review</h3>
              <span class="priority" id="detailPriority">--</span>
            </div>
            <p class="muted" id="detailMeta">Choose a review to see the details and send a response.</p>
            <p id="detailText"></p>
            <label for="replyBox" class="muted" style="display:block; margin: 10px 0 6px;">Response Draft</label>
            <textarea id="replyBox" placeholder="AI response draft will appear here..."></textarea>
            <div class="actions">
              <button class="btn" id="generateBtn">Generate AI Draft</button>
              <button class="btn secondary" id="saveBtn">Save Draft</button>
              <button class="btn" id="sendBtn">Send Response</button>
              <button class="btn warn" id="escalateBtn">Escalate</button>
              <button class="btn danger" id="clearBtn">Clear</button>
            </div>
            <div id="statusMessage" class="status"></div>
          </div>
        </section>
      </main>
    </div>

    <script>
      const reviews = [
        { id: 1, name: "Taylor B.", location: "Harbor Point", rating: 5, source: "Google", text: "Amazing service and super quick pickup.", age: "12m", status: "pending", priority: "low" },
        { id: 2, name: "Sam R.", location: "Midtown", rating: 2, source: "Yelp", text: "I waited 25 mins and no one could help me at checkout.", age: "24m", status: "pending", priority: "high" },
        { id: 3, name: "Jordan K.", location: "Lakeside", rating: 4, source: "Facebook", text: "Great staff. Wish there were more size options.", age: "1h", status: "drafted", priority: "medium" },
        { id: 4, name: "Casey M.", location: "Downtown", rating: 1, source: "Google", text: "Wrong order twice and manager never called back.", age: "1h", status: "escalated", priority: "high" },
        { id: 5, name: "Alex P.", location: "Uptown", rating: 5, source: "Google", text: "Clean store, friendly team, checkout was seamless.", age: "2h", status: "pending", priority: "low" },
        { id: 6, name: "Morgan J.", location: "Riverside", rating: 3, source: "Yelp", text: "Decent experience but pickup instructions were confusing.", age: "3h", status: "pending", priority: "medium" }
      ];

      const templates = {
        5: "Thank you so much for the 5-star feedback, {{name}}! We shared your note with the {{location}} team and hope to see you again soon.",
        4: "Thanks for your review, {{name}}! We appreciate your feedback and will keep improving at {{location}}.",
        3: "Thanks for the honest feedback, {{name}}. We are reviewing your comments with the {{location}} team and will work on a better experience.",
        2: "Hi {{name}}, we are sorry your visit at {{location}} missed the mark. Please message us directly so we can make this right.",
        1: "{{name}}, we sincerely apologize for your experience at {{location}}. Our manager has been alerted and will follow up immediately."
      };

      const state = { selectedId: null };
      const reviewList = document.getElementById("reviewList");
      const locationFilter = document.getElementById("locationFilter");
      const ratingFilter = document.getElementById("ratingFilter");
      const statusFilter = document.getElementById("statusFilter");
      const searchFilter = document.getElementById("searchFilter");
      const replyBox = document.getElementById("replyBox");
      const statusMessage = document.getElementById("statusMessage");

      function flash(msg) {
        statusMessage.textContent = msg;
        statusMessage.style.display = "block";
        setTimeout(() => (statusMessage.style.display = "none"), 2300);
      }

      function priorityClass(priority) {
        return priority === "high" ? "high" : priority === "medium" ? "medium" : "low";
      }

      function stars(rating) {
        return "★".repeat(rating) + "☆".repeat(5 - rating);
      }

      function getFilteredReviews() {
        return reviews.filter((review) => {
          const locationOK = locationFilter.value === "all" || review.location === locationFilter.value;
          const ratingOK = ratingFilter.value === "all" || String(review.rating) === ratingFilter.value;
          const statusOK = statusFilter.value === "all" || review.status === statusFilter.value;
          const searchOK = review.text.toLowerCase().includes(searchFilter.value.toLowerCase()) || review.name.toLowerCase().includes(searchFilter.value.toLowerCase());
          return locationOK && ratingOK && statusOK && searchOK;
        });
      }

      function renderStats() {
        const pending = reviews.filter((r) => r.status === "pending").length;
        const escalated = reviews.filter((r) => r.status === "escalated" || r.rating <= 2).length;
        const drafts = reviews.filter((r) => r.status === "drafted").length;
        document.getElementById("statPending").textContent = pending;
        document.getElementById("statEscalated").textContent = escalated;
        document.getElementById("statDrafts").textContent = drafts;
      }

      function renderList() {
        const filtered = getFilteredReviews();
        reviewList.innerHTML = filtered.map((review) => `
          <div class="review-item ${state.selectedId === review.id ? "active" : ""}" data-id="${review.id}">
            <strong>${review.name}</strong>
            <div class="stars">${stars(review.rating)}</div>
            <div>${review.text}</div>
            <div class="meta">${review.source} · ${review.location} · ${review.age} ago · ${review.status}</div>
            <span class="priority ${priorityClass(review.priority)}">${review.priority.toUpperCase()}</span>
          </div>
        `).join("") || `<div class="muted">No reviews match your filters.</div>`;

        reviewList.querySelectorAll(".review-item").forEach((item) => {
          item.addEventListener("click", () => {
            state.selectedId = Number(item.dataset.id);
            renderList();
            renderDetail();
          });
        });
      }

      function renderDetail() {
        const review = reviews.find((r) => r.id === state.selectedId);
        const priority = document.getElementById("detailPriority");

        if (!review) {
          document.getElementById("detailName").textContent = "Select a review";
          document.getElementById("detailMeta").textContent = "Choose a review to see the details and send a response.";
          document.getElementById("detailText").textContent = "";
          priority.textContent = "--";
          priority.className = "priority";
          replyBox.value = "";
          return;
        }

        document.getElementById("detailName").textContent = `${review.name} · ${stars(review.rating)}`;
        document.getElementById("detailMeta").textContent = `${review.source} · ${review.location} · ${review.age} ago · Status: ${review.status}`;
        document.getElementById("detailText").textContent = review.text;
        priority.textContent = review.priority.toUpperCase();
        priority.className = `priority ${priorityClass(review.priority)}`;
        replyBox.value = review.reply || "";
      }

      function generateDraft() {
        const review = reviews.find((r) => r.id === state.selectedId);
        if (!review) return flash("Pick a review first.");
        review.reply = templates[review.rating].replace("{{name}}", review.name).replace("{{location}}", review.location);
        review.status = "drafted";
        renderStats();
        renderList();
        renderDetail();
        flash("AI draft generated.");
      }

      function saveDraft() {
        const review = reviews.find((r) => r.id === state.selectedId);
        if (!review) return flash("Pick a review first.");
        review.reply = replyBox.value.trim();
        review.status = "drafted";
        renderStats();
        renderList();
        renderDetail();
        flash("Draft saved.");
      }

      function sendResponse() {
        const review = reviews.find((r) => r.id === state.selectedId);
        if (!review) return flash("Pick a review first.");
        if (!replyBox.value.trim()) return flash("Generate or write a response first.");
        review.reply = replyBox.value.trim();
        review.status = "sent";
        renderStats();
        renderList();
        renderDetail();
        flash("Response sent successfully.");
      }

      function escalateReview() {
        const review = reviews.find((r) => r.id === state.selectedId);
        if (!review) return flash("Pick a review first.");
        review.status = "escalated";
        review.priority = "high";
        renderStats();
        renderList();
        renderDetail();
        flash("Review escalated to manager queue.");
      }

      function clearResponse() {
        const review = reviews.find((r) => r.id === state.selectedId);
        if (!review) return flash("Pick a review first.");
        review.reply = "";
        review.status = "pending";
        renderStats();
        renderList();
        renderDetail();
        flash("Draft cleared.");
      }

      function bulkAutoReply() {
        const filtered = getFilteredReviews();
        let changed = 0;
        filtered.forEach((review) => {
          if (review.status === "pending" && review.rating >= 4) {
            review.reply = templates[review.rating].replace("{{name}}", review.name).replace("{{location}}", review.location);
            review.status = "drafted";
            changed += 1;
          }
        });
        renderStats();
        renderList();
        renderDetail();
        flash(`Auto-reply created ${changed} draft(s).`);
      }

      const locations = [...new Set(reviews.map((r) => r.location))];
      locations.forEach((loc) => {
        const option = document.createElement("option");
        option.value = loc;
        option.textContent = loc;
        locationFilter.appendChild(option);
      });

      [locationFilter, ratingFilter, statusFilter, searchFilter].forEach((el) => el.addEventListener("input", renderList));
      document.getElementById("generateBtn").addEventListener("click", generateDraft);
      document.getElementById("saveBtn").addEventListener("click", saveDraft);
      document.getElementById("sendBtn").addEventListener("click", sendResponse);
      document.getElementById("escalateBtn").addEventListener("click", escalateReview);
      document.getElementById("clearBtn").addEventListener("click", clearResponse);
      document.getElementById("bulkReply").addEventListener("click", bulkAutoReply);

      renderStats();
      renderList();
      renderDetail();
    </script>
  </body>
</html>
